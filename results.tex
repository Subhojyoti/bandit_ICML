	
We now state the main result that upper bounds the expected regret of ClusUCB.
	
\begin{theorem}[\textbf{\textit{Regret bound}}]
\label{Result:Theorem:1}
The regret $R_T$ of ClusUCB satisfies
\begin{align*}
&\E [R_{T}]\leq 
\sum\limits_{\substack{i\in A_{s^{*}},\\\Delta_{i} > b}}\bigg\lbrace \dfrac{C_1(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}} + \Delta_{i}\\
& + \frac{32\rho_{a}\log{(\psi T\dfrac{\Delta_{i}^{4}}{16\rho_{a}^{2}})}}{\Delta_{i}} \bigg\rbrace
 + \! \! \sum\limits_{\substack{i\in A,\\\Delta_{i} > b}} \bigg\lbrace 2\Delta_{i}+
\dfrac{C_1(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}} \\
&+ \frac{32\rho_{a}\log{(\psi T\dfrac{\Delta_{i}^{4}}{16\rho_{a}^{2}})}}{\Delta_{i}} 
+ \dfrac{32\rho_{s}\log{(\psi T\dfrac{\Delta_{i}^{4}}{16\rho_{s}^{2}})}}{\Delta_{i}}\bigg\rbrace \\
%%%
&+ \sum\limits_{\substack{i\in A_{s^{*}},\\ \Delta_{i} > b}} 
\frac{C_2(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}}
+\sum\limits_{\substack{i\in A_{s^{*}},\\0 < \Delta_{i}\leq b}}\frac{C_2(\rho_a)T^{1-\rho_{a}}}{b^{4\rho_{a} -1}}\\ 
%%%%%%%
%&+ \!\sum\limits_{\substack{i\in A,\\ \Delta_{i} > b}}\! \! \dfrac{C_2(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}}
% + \!\sum\limits_{\substack{i\in A,\\0 < \Delta_{i}\leq b}}\! \! \dfrac{C_2(\rho_{s})T^{1-\rho_{s}}}{b^{4\rho_{s} -1}}  \\
&+ \sum_{\substack{i\in A\setminus A_{s^*}:\\\Delta_{i}> b}}\dfrac{2C_{2}(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}} +\sum_{\substack{i\in A \setminus A_{s^*}:\\ 0 < \Delta_{i} \leq b}}\dfrac{2C_{2}(\rho_{s})T^{1-\rho_{s}}}{b^{4\rho_{s}-1}}\\
& \!+\! \max\limits_{i:\Delta_{i}\leq b}\Delta_{i}T, 
\end{align*}
%\begin{align*}
%&\E [R_{T}]\!\leq\! 
%\sum\limits_{\substack{i\in A_{s^{*}},\\\Delta_{i} > b}}\dfrac{C_1(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}} 
%+ \sum\limits_{\substack{i\in A \setminus A_{s^{*}},\\\Delta_{i}^{'} > b}} \dfrac{C_1(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{'^{4\rho_{a}-1}}} \\
%&+ \sum\limits_{\substack{i\in A,\\\Delta_{i} > b}} \bigg\lbrace 2\Delta_{i}+
%\dfrac{2C_1(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}} 
%+ \frac{32\rho_{a}\log{(\psi T\dfrac{\Delta_{i}^{4}}{16\rho_{a}^{2}})}}{\Delta_{i}} \\
%&+ \dfrac{32\rho_{s}\log{(\psi T\dfrac{\Delta_{i}^{4}}{16\rho_{s}^{2}})}}{\Delta_{i}}\bigg\rbrace  
%%%
%+ \sum\limits_{\substack{i\in A_{s^{*}},\\ \Delta_{i} > b}} 
%\frac{C_2(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}}\\ 
%& +\sum\limits_{\substack{i\in A_{s^{*}},\\0\leq\Delta_{i}\leq b}}\frac{C_2(\rho_a)T^{1-\rho_{a}}}{b^{4\rho_{a} -1}} + 
%%%%%%%
%\!\sum\limits_{\substack{i\in A,\\ \Delta_{i} > b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}}\\
%& + \!\sum\limits_{\substack{i\in A,\\0\leq\Delta_{i}\leq b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{b^{4\rho_{s} -1}}  
%\!+\! \max\limits_{i:\Delta_{i}\leq b}\Delta_{i}T, 
%\end{align*}
where $b\geq \sqrt{\frac{K}{7T}}$, $C_1(x) = \frac{2^{1+4x}x^{2x}}{\psi^{x}}$, $C_2(x) = \frac{2^{2x+\frac{3}{2}}x^{2x}}{\psi^{x}}$ and $A_{s^{*}}$ is the subset of arms in cluster $s^{*}$ containing optimal arm $a^{*}$.
%, $\rho_{a}=\dfrac{1}{2},\rho_{s}=\dfrac{1}{2}$ and $\psi=K^{2}T$.
\end{theorem}
\begin{proof}
 See Section \ref{sec:proofTheorem}.
\end{proof}

%, $\Delta_{i}^{'}=r_{a_{\max_{s_{k}}}} - r_{i}$, such that $a_{i}\in s_{k}$
	
%\begin{remark}
%\label{Result:Rem:1}
%By setting $b=\sqrt{\dfrac{e}{T}}$, the term $max_{i:\Delta_{i}\leq b}\Delta_{i}T$ gets trivially bounded by $\sqrt{KT}$ as mentioned in UCB-Improved.
%%which makes the logarithmic term  the main term for suitable $b$
%\end{remark}

We now specialize the result in the theorem above by substituting specific values for the exploration constants $\rho_{s}$, $\rho_{a}$ and $\psi$. 
%and how these values are reduced after every round significantly affects our regret bound. A discussion on their various definitions are given in Appendix \ref{App:E}. A discussion on exploration regulatory factor($\psi$) and its effect is deferred to Appendix \ref{App:D}. A discussion on the three approaches of using only arm elimination in Algorithm 1 or using only cluster elimination or using both is deferred to Remark \ref{App:E:Rem:1}(Appendix \ref{App:E}).

%%%% Gap dependent bound
\begin{corollary}[\textbf{\textit{Gap-dependent bound}}]
\label{Result:Corollary:1}
With $\psi=\frac{T}{\log (K)}$, $\rho_{a}=\frac{1}{2}$ and $\rho_{s}=\frac{1}{2}$,  we have the following gap-dependent bound for the regret of ClusUCB:
% \begin{align*}
% \E [R_T] &\!\le\! \sum_{\substack{i\in A_{s^{*}}: \\ \Delta_{i} > b}}\dfrac{4\sqrt{\log (KT)}}{\Delta_{i}} + \sum_{i\in A:\Delta_{i} > b}\bigg\lbrace 3\Delta_{i}\\
% & + \dfrac{6.8\sqrt{\log (KT)}}{\Delta_{i}}  + \dfrac{96\log{(\frac{T\Delta_{i}^{2}}{\sqrt{\log (KT)}})}}{\Delta_{i}}\bigg\rbrace \\
% &+ \sum\limits_{\substack{i\in A_{s^{*}},\\ \Delta_{i} > b}}\dfrac{2.8\sqrt{\log (KT)}}{\Delta_{i}} + \sum\limits_{\substack{i\in A_{s^{*}},\\0\leq\Delta_{i}\leq b}}\dfrac{2.8\sqrt{\log (KT)}}{\Delta_{i}} \\ 
% &+ \sum\limits_{\substack{i\in A,\\0\leq\Delta_{i}\leq b}}\dfrac{2.8\sqrt{\log (KT)}}{\Delta_{i}} + \max\limits_{i\in A:\Delta_{i}\leq b}\Delta_{i}T
% \end{align*} 
\begin{align*}
&\E [R_T] \!\le\! 
\sum_{\substack{i\in A_{s^{*}}:\\\Delta_{i} > b}}\bigg\lbrace \dfrac{6.8\sqrt{\log (KT)}}{\Delta_{i}} + \Delta_{i} + \\
& \dfrac{32\log{(T\dfrac{\Delta_{i}^{2}}{\sqrt{\log (K)}})}}{\Delta_{i}} \bigg\rbrace + \sum_{i\in A:\Delta_{i} > b}\bigg\lbrace\dfrac{4\sqrt{\log (K)}}{\Delta_{i}} + 2\Delta_{i} \\
& + \dfrac{64\log{(T\dfrac{\Delta_{i}^{2}}{\sqrt{\log (K)}})}}{\Delta_{i}}\bigg\rbrace
	  + \sum\limits_{\substack{i\in A_{s^{*}}:\\0< \Delta_{i} \leq b}}\dfrac{2.8\sqrt{\log (K)}}{\Delta_{i}}\\
	& + \sum\limits_{\substack{i\in A\setminus A_{s^{*}}:\\\Delta_{i} > b}}\dfrac{5.6\sqrt{\log (K)}}{\Delta_{i}} + \sum\limits_{\substack{i\in A\setminus A \cup A_{s^{*}}:\\0 < \Delta_{i}\leq b}}\dfrac{5.6\sqrt{\log (K)}}{\Delta_{i}} \\
	& + \max\limits_{i\in A:\Delta_{i}\leq b}\Delta_{i}T, \quad \text{ for all }b\geq \sqrt{\frac{K}{7T}}.
	\end{align*} 
\end{corollary}
\begin{proof}
 See Appendix \ref{App:Proof:Corollary:1}.
\end{proof}

%\sum_{i\in A_{s^{*}}:\Delta_{i} > b}\dfrac{4\sqrt{\log (KT)}}{\Delta_{i}} + \sum_{i\in A:\Delta_{i} > b}\bigg\lbrace\dfrac{12\sqrt{\log (KT)}}{\Delta_{i}}  + 3\Delta_{i} +\dfrac{96\log{(T\dfrac{\Delta_{i}^{2}}{\sqrt{\log (KT)}})}}{\Delta_{i}}\bigg\rbrace + \sum\limits_{i\in A_{s^{*}}:\Delta_{i} > b}\dfrac{2.8\sqrt{\log (KT)}}{\Delta_{i}} 
%	\\ &+ \sum\limits_{i\in A_{s^{*}}:0\leq\Delta_{i}\leq b}\dfrac{2.8\sqrt{\log (KT)}}{\Delta_{i}}
%	 + \sum\limits_{i\in A:0\leq\Delta_{i}\leq b}\dfrac{8\sqrt{\log (KT)}}{\Delta_{i}} + \max\limits_{i:\Delta_{i}\leq b}\Delta_{i}T

%Considering the same gap of $\Delta_{i} = \Delta_{i}^{'}, \forall i\in A$ and 
%\begin{remark}
%\label{Result:Rem:4}
The most significant term in the bound above is $\sum_{i\in A:\Delta_{i}\geq b}\frac{64\log{\big(T\frac{\Delta_{i}^{2}}{\sqrt{\log (K)}}\big)}}{\Delta_{i}}$ and hence, the regret upper bound for ClusUCB is of the order $O\bigg(\frac{K\log \big(\frac{T\Delta^{2}}{\sqrt{\log (K)}}\big)}{\Delta}\bigg)$. As shown in Table \ref{tab:regret-bds}, the gap-dependent bound of ClusUCB is always better than UCB1 and UCB-Improved. 

%In comparison to the gap-dependent bound of MOSS, we observe that ClusUCB will be better if 
%$\frac{T^{K-1}\Delta^{2K-2}}{K^{K}} > \frac{1}{\sqrt{\log(KT)}}$, which is equivalent to $\Delta > \frac{2}{\sqrt{T}(\log 2T)^{\frac{1}{4}}}$ for
%$K\geq 2$. Since Corollary \ref{Result:Corollary:1} holds for all $\Delta \geq \sqrt{\frac{e}{T}} > \frac{2}{\sqrt{T}(\log 2T)^{\frac{1}{4}}}$, it can be clearly seen that for all $\sqrt{\frac{e}{T}} \leq \Delta\leq 1$ and $K\geq 2$, the gap-dependent bound is better than MOSS.

Since Corollary \ref{Result:Corollary:1} holds for all $\Delta \geq \sqrt{\frac{K}{7T}} $, it can be clearly seen that for all $\sqrt{\frac{K}{7T}} \leq \Delta\leq 1$ and $K\geq 2$, the gap-dependent bound is better than that of MOSS and UCB-Improved. Also, since UCB-Improved holds for $\sqrt{\frac{e}{T}}\leq \Delta\leq 1$, in ClusUCB if we take $\gamma$ such that $\frac{K}{\gamma}\approx e$ then $\Delta\geq\sqrt{\frac{K}{\gamma T}}\geq \sqrt{\frac{e}{T}}$ and we can easily mimic the same guarantee as UCB-Improved. In the theoretical results as well as in the experiments we have take $\gamma =7$. 


\begin{corollary}[\textbf{\textit{Gap-independent bound}}]
\label{Result:Corollary:2}
Considering the same gap of $\Delta_{i} = \Delta =\sqrt{\frac{K\log K}{T}}$ for all ${i:i\neq *}$ and with $\psi=\frac{T}{\log K}$, $p=\big\lceil\frac{K}{\log K}\big\rceil$, $\rho_{a}=\frac{1}{2}$ and $\rho_{s}=\frac{1}{2}$, 
 we have the following gap-independent bound for the regret of ClusUCB:
% \begin{align*}
% &\E [R_T] \le  6\dfrac{\sqrt{KT}}{p} + 128\sqrt{KT\log K} \\
%  &+ \dfrac{64\sqrt{KT}\log{(\log K)}}{\sqrt{\log K}}+ 6.8\sqrt{\dfrac{T}{K\log K}} + 2.8\sqrt{\dfrac{T}{e}}
% \end{align*}
\begin{align*}
%\E [R_T] \le &
%\frac{6\sqrt{KT}}{p} \!+\! \frac{32\sqrt{KT\log K}}{p} \!+\! \frac{16\sqrt{KT}\log{(\log K)}}{p\sqrt{\log K}}\\
%&+ 9.6\sqrt{\frac{T}{K\log K}} + 96\sqrt{KT\log K}
% \\&  + \frac{48\sqrt{KT}\log{(\log K)}}{\sqrt{\log K}} + 5.6\sqrt{\frac{T}{e}}. 
 \E[R_{T}]\le & 70.8\dfrac{\sqrt{T}\log K}{\sqrt{K}} \!+\! \dfrac{32\sqrt{T\log K}\log{(\log K)}}{\sqrt{K}}\\
  &\!+\! 4\sqrt{KT} \!+\! 128\sqrt{KT\log K}\\
	& + \dfrac{64\sqrt{KT}\log{(\log K)}}{\sqrt{\log K}} + 2.8\sqrt{\dfrac{T\log K}{e}}\\
	& + 5.6\sqrt{\dfrac{T}{e}}(\log K)^{\frac{3}{2}} + 5.6 \dfrac{K}{K+\log K}\sqrt{KT}
\end{align*}
\end{corollary}
\begin{proof}
 See Appendix \ref{App:Proof:Corollary:2}.
\end{proof}


From the above result, we observe that the order of the regret upper bound of ClusUCB is $O(\sqrt{KT\log K})$ and this matches the order of UCB-Improved. However, this is not as low as the order $O(\sqrt{KT})$ of MOSS. 


%On the other hand, the current analysis used to arrive at Theorem \ref{Result:Theorem:1} for ClusUCB is not enough to obtain the order $O(\sqrt{KT})$ bound of MOSS.


%\begin{corollary}[\textbf{\textit{Gap-independent bound}}]
%\label{Result:Corollary:3}
%With $\psi=K^{2}T$, $\rho_{a}=\dfrac{1}{4}$ ,$\rho_{s}=\dfrac{1}{2} $ and $b\approx\sqrt{\dfrac{K\log K}{T}}$, the regret of ClusUCB is bounded  by $\bigg\lbrace 2\sqrt{KT} + 64\sqrt{KT\log K} + \dfrac{32\log{(\log K)}}{\sqrt{\log K}} + 4\dfrac{\sqrt{KT}}{p}  + 16\sqrt{\dfrac{T}{K\log K}}\bigg\rbrace$.
%\end{corollary}
%\begin{proof}
% See Appendix \ref{App:Proof:Corollary:3}.
% 
%From the above result we see that this bound is less than than the bound in Corollary \ref{Result:Corollary:2}. Here we also define the error bound, which is the bound on the regret obtained after elimination of the optimal arm $a^{*}$. So the  error bound from Corollary \ref{Result:Corollary:2} is 
%
%\begin{align*}
%5.6\sqrt{KT} + 4\dfrac{\sqrt{KT}}{p}
%\end{align*}
%
%which is more than the error bound from Corollary \ref{Result:Corollary:3},
%
%\begin{align*}
%16\sqrt{\dfrac{T}{K\log K}} + 4\dfrac{\sqrt{KT}}{p}
%\end{align*}
%
%for $ \sqrt{\log K} \leq p\leq\frac{K}{2}$. So by taking $\rho_{a} < \rho_{s}$ we are able to reduce the error bound and this helps the algorithm to perform better in regimes where the gaps are small by keeping the optimal arm safe with high probability. 
%
%\end{proof}

\subsection*{Analysis of elimination error}
Let $\tilde R_T$ denote the contribution  to the expected regret in the case when the optimal arm $*$ gets eliminated during one of the rounds of ClusUCB. This can happen if a sub-optimal arm eliminates $*$ or if a sub-optimal cluster eliminates the cluster $s^*$ that contains $*$ - these correspond to cases b2 and b3 in the proof of Theorem \ref{Result:Theorem:1} (see Section \ref{sec:proofTheorem}). 
%Let $E_{m,j}$ denote the event that the optimal arm is eliminated by a sub-optimal arm $j$ in round $m$ of ClusUCB. 
%\begin{align}
%\tilde R_T = \sum_{m=0}^{max_{j\in A^{'}}m_{j}}\sum_{i\in A^{''}:m_{i}>m_{*}}\bigg(\dfrac{2}{(\psi  T\epsilon_{m}^{2})^{\rho_{a}}} \bigg).T\max_{j\in A^{''}:m_{j}\geq m_{*}}{\Delta}_{j}
%\end{align}
We shall denote variants of ClusUCB that include arm elimination condition only and cluster elimination condition only as ClusUCB-AE and ClusUCB-CE, respectively, while ClusUCB corresponds to Algorithm \ref{alg:clusucb}, which uses both arm and cluster elimination conditions.

For ClusUCB-AE, the quantity $\tilde R_T$ can be extracted from the proofs (in particular, case b2 in Appendix \ref{App:A}) 
%as
%\begin{align*}
%& \sum\limits_{\substack{i\in A,\\ \Delta_{i}\geq b}}\! \! \bigg\lbrace \frac{C_2(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}}+ \sum\limits_{\substack{i\in A_{s^{*}},\\0\leq\Delta_{i}\leq b}}\frac{C_2(\rho_a)T^{1-\rho_{a}}}{b^{4\rho_{a} -1}} \bigg\rbrace. 
%\end{align*}  
and simplified using the values $\rho_{a}=\frac{1}{2}$ and $\psi=\frac{T}{\log K}$, to obtain $\tilde R_T = 2\sqrt{KT\log K}$. 

A similar exercise for ClusUCB-CE (see Case b2 in Appendix \ref{App:B}) 
%\begin{align*}
%\!\sum\limits_{\substack{i\in A,\\ \Delta_{i}\geq b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}} + \!\sum\limits_{\substack{i\in A,\\0\leq\Delta_{i}\leq b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{b^{4\rho_{s} -1}}.
%\end{align*}  
with $\rho_{s}=\frac{1}{2}$ and $\psi=\frac{T}{\log K}$ yields $\tilde R_T = 4\sqrt{KT\log K}$. 

Finally, for ClusUCB, the relevant terms from Theorem \ref{Result:Theorem:1} that corresponds to $\tilde R_T$ 
%are 
%\begin{align*}
%& \sum\limits_{\substack{i\in A,\\ \Delta_{i}\geq b}}\! \! \bigg\lbrace \frac{C_2(\rho_{a})T^{1-\rho_{a}}}{\Delta_{i}^{4\rho_{a}-1}}+ \sum\limits_{\substack{i\in A_{s^{*}},\\0\leq\Delta_{i}\leq b}}\frac{C_2(\rho_a)T^{1-\rho_{a}}}{b^{4\rho_{a} -1}} \bigg\rbrace + \\
%%%%%%%%
%&\!\sum\limits_{\substack{i\in A,\\ \Delta_{i}\geq b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{\Delta_{i}^{4\rho_{s}-1}} + \!\sum\limits_{\substack{i\in A,\\0\leq\Delta_{i}\leq b}}\! \! \dfrac{2C_2(\rho_{s})T^{1-\rho_{s}}}{b^{4\rho_{s} -1}}.
%\end{align*}  
can be simplified with $\rho_{a}=\frac{1}{2}$, $\rho_{s}=\frac{1}{2},p=\big\lceil \frac{K}{\log K} \big\rceil$ and $\psi=\frac{T}{\log K}$ (as in Corollary \ref{Result:Corollary:2} to obtain  
$\tilde R_T = \frac{5.3 \sqrt{T}\log K^{\frac{3}{2}} }{\sqrt{K}} + \frac{5.3 \sqrt{T}\log K}{\sqrt{K}} + 10.6 \frac{K}{K+\log K}\sqrt{KT\log K} + 10.6 \frac{K}{K+\log K}\sqrt{KT}$.
%$\tilde R_T = 4\dfrac{\sqrt{KT}}{p} + 5.6\sqrt{\dfrac{T}{K\log K}} + 5.6\sqrt{\dfrac{T}{e}}.$
%for $b\geq \sqrt{\dfrac{e}{T}}.$ 
Hence, in comparison to ClusUCB-AE and ClusUCB-CE which has an elimination regret bound of $O(\sqrt{KT\log K})$, the elimination error contribution to regret is lower in ClusUCB which has a bound of $O(\frac{K}{K+\log K}\sqrt{KT\log K})$. %when $\sqrt{\log K}\leq p\leq \frac{K}{2}$. 
 
Thus, we observe that clustering in conjunction with improved exploration via $\rho_{a},\rho_{s}$,$p$ and $\psi$ helps in reducing the factor associated with $\sqrt{KT}$ for the gap-independent error regret bound for ClusUCB. A table containing the regret error bound is shown in Appendix \ref{App:E}. 
%Moreover, the most significant terms complementary  to $\tilde R_T$ in Theorem \ref{Result:Theorem:1} is  $\frac{\log\bigg(\psi\frac{T\Delta_{i}^{4}}{\rho_{s}^{2}}\bigg)}{\Delta_{i}}$ and a careful choice of $\psi,\rho_{a}$ and $\rho_{s}$ in Corollary \ref{Result:Corollary:1}   
%term and  helps in stabilizing the term $\log\bigg(\frac{\psi  T\Delta_{i}^{4}}{\rho_{s}^{2}}\bigg)$.
